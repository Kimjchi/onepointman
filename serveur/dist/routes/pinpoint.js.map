{"version":3,"sources":["../../routes/pinpoint.js"],"names":["express","require","router","Router","db","squelb","squel","useFlavour","sender","post","req","res","toCreate","iduser","body","idgroup","pinlg","pinlt","description","query","insert","into","set","toString","then","sendResponse","SUCCESS_STATUS","catch","NOT_FOUND_STATUS","console","log","e","delete","toDelete","idpinpoint","from","where","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,SAASF,QAAQG,MAAR,EAAf;AACA,IAAMC,KAAKH,QAAQ,eAAR,CAAX;AACA,IAAMI,SAASJ,QAAQ,OAAR,CAAf;AACA,IAAMK,QAAQD,OAAOE,UAAP,CAAkB,UAAlB,CAAd;;AAEA,IAAMC,SAASP,QAAQ,WAAR,CAAf;;AAEAC,OAAOO,IAAP,CAAY,kBAAZ,EAAgC,UAAUC,GAAV,EAAeC,GAAf,EAAoB;;AAEhD,QAAIC,WAAW;AACXC,gBAAQH,IAAII,IAAJ,CAASD,MADN;AAEXE,iBAASL,IAAII,IAAJ,CAASC,OAFP;AAGXC,eAAON,IAAII,IAAJ,CAASE,KAHL;AAIXC,eAAOP,IAAII,IAAJ,CAASG,KAJL;AAKXC,qBAAaR,IAAII,IAAJ,CAASI;AALX,KAAf;;AAQA,QAAIC,QAAQb,MAAMc,MAAN,GACPC,IADO,CACF,mBADE,EAEPC,GAFO,CAEH,WAFG,EAEUV,SAASC,MAFnB,EAGPS,GAHO,CAGH,SAHG,EAGQV,SAASG,OAHjB,EAIPO,GAJO,CAIH,OAJG,EAIMV,SAASK,KAJf,EAKPK,GALO,CAKH,OALG,EAKMV,SAASI,KALf,EAMPM,GANO,CAMH,aANG,EAMYV,SAASM,WANrB,EAOPK,QAPO,EAAZ;;AASAnB,OAAGe,KAAH,CAASA,KAAT,EACKK,IADL,CACU,YAAI;AACNhB,eAAOiB,YAAP,CAAoBjB,OAAOkB,cAA3B,EAA2C,kBAA3C,EAA+Df,GAA/D;AACH,KAHL,EAIKgB,KAJL,CAIW,aAAK;AACRnB,eAAOiB,YAAP,CAAoBjB,OAAOoB,gBAA3B,EAA6C,+BAA7C,EAA8EjB,GAA9E;AACAkB,gBAAQC,GAAR,CAAYC,CAAZ;AACH,KAPL;AASH,CA5BD;;AA8BA7B,OAAO8B,MAAP,CAAc,kBAAd,EAAkC,UAAUtB,GAAV,EAAeC,GAAf,EAAoB;;AAElD,QAAIsB,WAAW;AACXpB,gBAAQH,IAAII,IAAJ,CAASD,MADN;AAEXE,iBAASL,IAAII,IAAJ,CAASC,OAFP;AAGXmB,oBAAYxB,IAAII,IAAJ,CAASoB;AAHV,KAAf;;AAMA,QAAIf,QAAQb,MAAM0B,MAAN,GACPG,IADO,CACF,mBADE,EAEPC,KAFO,CAED,eAFC,EAEgBH,SAASpB,MAFzB,EAGPuB,KAHO,CAGD,aAHC,EAGcH,SAASlB,OAHvB,EAIPqB,KAJO,CAID,gBAJC,EAIiBH,SAASC,UAJ1B,EAKPX,QALO,EAAZ;;AAOAnB,OAAGe,KAAH,CAASA,KAAT,EACKK,IADL,CACU,YAAI;AACNhB,eAAOiB,YAAP,CAAoBjB,OAAOkB,cAA3B,EAA2C,kBAA3C,EAA+Df,GAA/D;AACH,KAHL,EAIKgB,KAJL,CAIW,aAAK;AACRnB,eAAOiB,YAAP,CAAoBjB,OAAOoB,gBAA3B,EAA6C,+BAA7C,EAA8EjB,GAA9E;AACAkB,gBAAQC,GAAR,CAAYC,CAAZ;AACH,KAPL;AASH,CAxBD;;AA0BAM,OAAOC,OAAP,GAAiBpC,MAAjB","file":"pinpoint.js","sourcesContent":["const express = require('express');\r\nconst router = express.Router();\r\nconst db = require('../connection');\r\nconst squelb = require('squel');\r\nconst squel = squelb.useFlavour('postgres');\r\n\r\nconst sender = require('../sender');\r\n\r\nrouter.post('/createpinpoint/', function (req, res) {\r\n\r\n    let toCreate = {\r\n        iduser: req.body.iduser,\r\n        idgroup: req.body.idgroup,\r\n        pinlg: req.body.pinlg,\r\n        pinlt: req.body.pinlt,\r\n        description: req.body.description,\r\n    };\r\n\r\n    let query = squel.insert()\r\n        .into('public.\"PINPOINT\"')\r\n        .set('idcreator', toCreate.iduser)\r\n        .set('idgroup', toCreate.idgroup)\r\n        .set('pinlt', toCreate.pinlt)\r\n        .set('pinlg', toCreate.pinlg)\r\n        .set('description', toCreate.description)\r\n        .toString();\r\n\r\n    db.query(query)\r\n        .then(()=>{\r\n            sender.sendResponse(sender.SUCCESS_STATUS, 'Pinpoint created', res)\r\n        })\r\n        .catch(e => {\r\n            sender.sendResponse(sender.NOT_FOUND_STATUS, 'Error while creating pinpoint', res);\r\n            console.log(e);\r\n        })\r\n\r\n});\r\n\r\nrouter.delete('/deletepinpoint/', function (req, res) {\r\n\r\n    let toDelete = {\r\n        iduser: req.body.iduser,\r\n        idgroup: req.body.idgroup,\r\n        idpinpoint: req.body.idpinpoint,\r\n    };\r\n\r\n    let query = squel.delete()\r\n        .from('public.\"PINPOINT\"')\r\n        .where('idcreator = ?', toDelete.iduser)\r\n        .where('idgroup = ?', toDelete.idgroup)\r\n        .where('idpinpoint = ?', toDelete.idpinpoint)\r\n        .toString();\r\n\r\n    db.query(query)\r\n        .then(()=>{\r\n            sender.sendResponse(sender.SUCCESS_STATUS, 'Pinpoint deleted', res)\r\n        })\r\n        .catch(e => {\r\n            sender.sendResponse(sender.NOT_FOUND_STATUS, 'Error while deleting pinpoint', res);\r\n            console.log(e);\r\n        })\r\n\r\n});\r\n\r\nmodule.exports = router;\r\n"]}